ほんの数日前まで知らなかったのだけれど、Excelマクロはアドインとして登録することができる。

ぼくはずっとそれを知らなかったがために、次のような面倒な手順を踏んでいた。複数のファイルで共通に使用したい処理(ファイルの体裁を整えるマクロなど)をひとつのExcelファイルに書いておき、それを作業前に開いて、必要ならAlt+F8からマクロを実行する。いま思えば謎の手法である。

謎の手法が生まれるまでの思考はこうだ。(1)面倒で単純な作業がある。(2)マクロを作れることに気づき、手軽に処理する。(3)複数のファイルで必要な処理であることに気づく。(4)おまけにマクロをうめこんだままにすると色々とまずい。(5)ひとつのExcelファイルにまとめておいて、他のExcelファイルを開きながら呼び出せばいいことに気づく。(6)謎の手法の完成。

謎の手法だと、マクロ用Excelファイルを開くのが面倒だ。実行もまどろっこしい。そこでアドインである。

マクロ用Excelファイルを名前を付けて保存から`*.xla`を選んで指定のフォルダに保存する。あとはアドインを有効にしてExcelを再起動し、ツールバーなどにマクロを登録してやれば良い。これであとはAlt+1などから実行できる。手軽で、そして便利だ。セル結合で文字が中央に行くのをやめさせてみたり、罫線を引きなおしさせてみたり、ズームを100%に戻したり、色々作ってみた。

そもそもなんでもかんでもExcelで作るのが間違っている。説明資料もExcel、マニュアルもExcel、設計書もExcel。間違っている。

17 min.
