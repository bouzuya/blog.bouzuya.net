[キーマップ v18](https://github.com/bouzuya/qmk_firmware/blob/824f218079f56ee336211622519dac53b22ea6f6/keyboards/lets_split/keymaps/bouzuya/keymap.c) をつくった。

[2018-02-21][] に設定した QMK firmware の debug を使いつつ、動きを見直している。今日はレイヤーまわりを直した。少なくとも汚い状態はなくなったと思う……のだけど、一部、仕様を忘れて誤った形にしてしまったっぽい。

たとえば↓の場合を考える。すごい簡単な場合なのだけど、これがおかしい。 oneshot っぽい動きをするので L1 U のあとは L1 に居る。 L3 U で L1 から L3 に移る。この状態で L1 に oneshot を残すべきところを消してしまった気がする。 layer key に oneshot を消費していいのかがブレている。たぶん消費されてはいけない。

```
L1 D
L1 U
L3 D
L3 U
```

ほかにも二度押しや押しっぱなしで壊れていたのを直した。そういったあれこれを直しているうちに仕様が分からなくなって、↑のようなブレを出してしまったっぽい。

まだ mod key はいろいろ残ったり、リピートで壊れていたりとアレな感じ。

[2018-02-21]: https://blog.bouzuya.net/2018/02/21/
